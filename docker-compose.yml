services:
  app:
    container_name: ksenia_backend_container
    build: .
    ports:
      - "7000:7000"
    env_file:
      - .env
    environment:
      - MONGO_URI=${MONGO_URI}
      - DB_NAME=${DB_NAME}
      - PORT=7000
      - TELEGRAM_BOT_TOKEN=${TELEGRAM_BOT_TOKEN}
    volumes:
      # Ð¡Ð¾Ñ…Ñ€Ð°Ð½ÑÐµÐ¼ Ð·Ð°Ð³Ñ€ÑƒÐ¶ÐµÐ½Ð½Ñ‹Ðµ Ñ„Ð°Ð¹Ð»Ñ‹ Ð¼ÐµÐ¶Ð´Ñƒ Ð¿ÐµÑ€ÐµÐ·Ð°Ð¿ÑƒÑÐºÐ°Ð¼Ð¸ (Ð’ÐÐ• ÐºÐ¾Ð½Ñ‚ÐµÐ¹Ð½ÐµÑ€Ð°)
      - ./uploads:/app/uploads
      # Ð’Ñ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ðµ Ñ„Ð°Ð¹Ð»Ñ‹ Ð´Ð»Ñ Ð³ÐµÐ½ÐµÑ€Ð°Ñ†Ð¸Ð¸ Ð²Ð¸Ð´ÐµÐ¾ (Ð’ÐÐ• ÐºÐ¾Ð½Ñ‚ÐµÐ¹Ð½ÐµÑ€Ð°)
      - ./temp:/app/temp
    restart: unless-stopped
    command: >
      sh -c "
        echo 'ðŸš€ Starting Ksenia Backend...' &&
        echo 'ðŸ“ Checking directories...' &&
        ls -la /app/uploads 2>/dev/null || echo 'Creating uploads...' &&
        echo 'ðŸŽ¬ Checking FFmpeg...' &&
        ffmpeg -version | head -n 1 &&
        echo 'âœ… Starting application...' &&
        npm start
      "